
#  node.js

#### 异步
###### 监听到某个事件后，再执行别的代码，不会影响后续代码的执行，这种方式被称为异步
###### 定时器 setTimeout， setInterval
###### ./表示当前路径
###### fs node自带模块可直接引用  fs文件操作模块

###  writeFile方法

- 1.写入的文件路径
- 2.需要写入的数据

3回调函数，只需要一个err，错误时显示err

### npm作用：

允许用户从NPM服务器下载别人编写的第三方包到本地使用。
允许用户从NPM服务器下载并安装别人编写的命令行程序到本地使用。
允许用户将自己编写的包或命令行程序上传到NPM服务器供别人使用。

### node项目创建流程
express +项目名称
npm install安装项目依赖模块
npm star 运行项目
HTTP客户端与服务端交互： 建立连接-》http客户端发送请求-》服务端接受请求生成结果，回应-》服务端关闭链接，客户端解析回应，恢复链接

路由：实际就是一个uri，或者说是路径和http组合而成的特定方法，每一个路由都一个或多个函数，当当路由与其匹配到时函数将被执行




# 数据库

### 基本操作：增删改查
创建数据库：create database + 数据库名称 +库选项
查询数据库：show database//基本操作，查看全部
show database like '';//模糊查询，查询部分
删除数据库：drop database + 数据库名称//删除不可逆
更新数据库：alter database +库名称+库选项
charset/charater set[=] 字符集
college[=] 校对集

### 表数据
表的一行表示一条记录
表中数据一一对应：id=1；name="jijifly"
![image](https://images2017.cnblogs.com/blog/1200440/201710/1200440-20171031163006808-599526687.png)

### 数据库常用类型
- 整型：int 
- 浮点型：double
- 日期类型：date
- 字符串类型：varchar

数据库管理结构，一般分为两种：
B/S架构 

C/S架构：mysql客户端与服务端

可以定义为高效的储存和处理数据一般来说，将 MySQL 数据库服务器的内部对象分为四层，分别为：数据管理系统（DBMS）–> 数据库（DB）–> 表（Table）–> 字段（Filed）.
SQL 中最重要的 DDL 语句:

- CREATE DATABASE - 创建新数据库
- ALTER DATABASE - 修改数据库
- CREATE TABLE - 创建新表
- ALTER TABLE - 变更（改变）数据库表
- DROP TABLE - 删除表
- CREATE INDEX - 创建索引（搜索键）
- DROP INDEX - 删除索引

### 列类型
![image](c:\Users\Administrator\Desktop\20170505201016682.jpg)

### 主键

表中主要的键，每张表中，只能有一个字段存在主键，但复合型字段可存在多主键

增加主键：在创建表的字段后面添加 primary key 
![image](C:\Users\Administrator\Desktop\20170523210307014.jpg)

复合型主键（表内存在多个主键）：在创建表字段后再添加primary key（字段1，字段2....）

追加主键：在表格创建完成后如果想要追加主键则用alter table +表名 add primary key +(字段名)

追加主键必须保证对应字段的数据不相同，保证其唯一性

主键约束：主键对应的字符数据不能够重复，如有重复则会导致数据修改删减的失败

主键分类：主键分为业务主键与逻辑主键


主键分类      |   .
---|--- |---
业务主键 | 例如学号，工号等真实存在的数据，通常不使用
逻辑主键 | 使用逻辑型字段使用，值有或无都没有关系，经常使用


### 自增长：auto_increment

1.任何字段要做自增长必须有一个索引，即key栏有值

2.要做自增长的字段必须为数字

3.一张表中最多只有一个自增长

使用自增长：当自增长中给定的值为null的时候则会出发自增长

删除自增长：alter table + 表名 +modify + 字段 +类型 ，要使用删除自增长要保证字段中不存在auto_increment

### 唯一键：

唯一键与主键本质基本相同，都是为了那些不能重复的数据而使用，区别是一张表中只能有一个主键，所以唯一键就是用来解决表中有多个字段的唯一性问题，表中唯一键可以允许有多个

### 索引：系统根据自己的算法，将已有或未来将有的数据建立一个文件，这个文件能快速匹配数据并且快速找到对应的记录

### 外键：即不在自己表中的键，也可以指在外面的键，一张表内可以有多个外键

增加外键：foreign key(外键字段)+references + 外部表名(主键字段);

主键  | 外键 
---|---
表中只能存在一个 | 在其他表内的主键
复合型主键可以存在多个 | 一个表内可以存在多个外键

### 索引的意义

1.提升查询数据的效率

2.约束数据的有效性

主键索引：primary key

唯一键索引:unique key

全文索引:fulltext index

普通索引:index

### 关系：数据库中关系是指表与表之间的关系，即一对一，一对多，多对一与多对多


### 主键冲突：即插入数据时，主键对应的数据已经有值，那么就会产生主键冲突

处理方式：

1.更新操作

2.替换操作

### 蠕虫复制：先查出数据，将数据复制一遍
insert +into +表名 +select +字段列表/*+from +表名；



### 更新数据：

基本语法：update +表名 +set +字段 = 值 +[where条件]

高级语法：update +表名 +set +字段 = 值 +[where条件] + [limit 更新数量]

### 删除数据

基本语法：delete + from +表名 +[where条件]

例子:  update my_copy set name = 'c' where name = 'a' limit 3;

高级语法：delete + from + 表名
+[where条件] +[limit 删除数量]


### 范式

主要是用于解决数据优化和储存问题

### 联合查询

将多次查询的结果，在相同的字段下，在记录的层次上进行拼接

### 视图

将一条复杂的查询语句用视图的方式来进行封装，并且可以直接对视图进行操作，视图对外是友好的，不同的数据可以封装成不同的视图


### 事件

当需要执行某些一连串的手动操作是需要用到

事务安全：如用户a向用户b的账户当中放入传入金额，而用户a完成操作后a的账户也减少了金额，但用户b的账户却没有收到用户a所传过来的金额，此时就需要事务安全
在开启事务后所有的手动操作都会先存储在临时文件内 只有commit之后才能进行提交，rollback进行回滚操作

开启事务：start transaction 

提交事务：commit
设置回滚点：savepoint + 回滚点名称
返回回滚点：rollback to +回滚点名称


### 变量的区分

在MySQL中变量分为两种，系统与自定义变量

系统变量：由系统设置的变量，所有系统变量都是全局级别变量，对所有客户端的任何一次连接都有效

自定义变量：由用户自己定义的变量都是会话级别的变量，只在当次连接有效


### 触发器

事先为某张表绑定一段代码，当表进行增删改的时候系统会自动触发并执行触发器代码

触发器三要素：
事件类型 | 增删改执行时               
---|---
事件时间 | 事件类型前后，before alter                 
事件范围 | 整张表

### 执行结构
  ![image](C:\Users\Administrator\Desktop\jiegou.png)     
  
### 函数

函数创建 create function +函数名（参数列表+数据类型）

删除函数 drop function +函数名

查看函数 show function status like '函数名'

### 变量作用域


全局变量：使用set关键字进行定义 ,@符号标识

局部变量：使用declare关键字声明,所用局部变量都只能在当前函数体进行之前进行定义

### 存储过程

存储过程是一组为了完成特定功能的sql语句集，经编译后存储在数据库中，用户通过存储过程中的名字并且给定参数来将其调用执行

语法：create procedure 过程名
begin
    --过程体
end
如果定义的过程的过程体内只包含一条鱼具，则可以省略begin和end

调用过程：call+过程名
过程只能被删除不能被修改  dorp poredure status like '过程名'

过程参数：in，out，inout
in：数据从过程外部传入过程内部，变量可以修改

out：只能传递变量，变量指向的数据要先清空才能传入内部，只供内部使用，只有在过程结束后才可以将变量的值传递给外部使用

inout：同上，但不需要清空后才能进入过程内部

过程的执行过程中，传入的变量不会影响的对应的局部变量，只有在过程执行完成过后才会将对应变量赋值给 out，inout类型变量。而in类型不会受到影响







### 幼麟棋牌服务器搭建

1.创建数据库导入数据库

2.修改http.js文件ip地址与mysql的配置

3.启动server目录下的start_all.sh







